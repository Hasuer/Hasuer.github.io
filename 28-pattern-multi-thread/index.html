<!DOCTYPE html>
<html lang="en">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Hasuer">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Hasuer">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="416. Partition Equal Subset Sum Design Gurus Educative.io ATTENTION: 这些题目还没有看 Introduction to Multi-threaded PatternIn many algorithms, concurrency and thread safety are very important. With technical">
<meta property="og:type" content="article">
<meta property="og:title" content="28. Pattern Multi-thread">
<meta property="og:url" content="https://hasuer.github.io/28-pattern-multi-thread/index.html">
<meta property="og:site_name" content="Hasuer&#39;s Studio.">
<meta property="og:description" content="416. Partition Equal Subset Sum Design Gurus Educative.io ATTENTION: 这些题目还没有看 Introduction to Multi-threaded PatternIn many algorithms, concurrency and thread safety are very important. With technical">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/1.png">
<meta property="og:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/2.png">
<meta property="og:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/3.png">
<meta property="og:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/4.png">
<meta property="og:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/5.png">
<meta property="article:published_time" content="2024-05-28T06:34:14.000Z">
<meta property="article:modified_time" content="2024-05-28T03:31:31.404Z">
<meta property="article:author" content="Hasuer">
<meta property="article:tag" content="Interview">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hasuer.github.io/28-pattern-multi-thread/index/1.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/old_profile.ico">
    
    <title>28. Pattern Multi-thread · Hasuer&#39;s Studio</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20210823" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20210823" as="style">
    <link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="/css/mobile.css?v=20210823" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20210823" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20210823" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>Hasuer's Studio.</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">Hasuer&#39;s Studio.</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">28. Pattern Multi-thread</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                28. Pattern Multi-thread
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        
        
            
        
        
        <span class="post-category" data-categories="Grokking Interview Pattern"">
            <i class="fas fa-folder post-category-icon"></i>
            <span class="post-category-text">
                Grokking Interview Pattern
            </span>
        </span>
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="Interview">Interview</a>
    
</div>

                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">3.2k</span>Reading time: <span class="post-count reading-time">19 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2024/05/28</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <p><span style="display: inline-block; padding: 0.25em 0.6em; font-size: 75%; font-weight: 700; line-height: 1; color: #ffffff; background-color: #97c50f; border-radius: 0.25rem; text-align: center; vertical-align: baseline;"><a target="_blank" rel="noopener" href="https://leetcode.com/problems/partition-equal-subset-sum/">416. Partition Equal Subset Sum</a></span> <span style="display: inline-block; padding: 0.25em 0.6em; font-size: 75%; font-weight: 700; line-height: 1; color: #ffffff; background-color: #1183c4; border-radius: 0.25rem; text-align: center; vertical-align: baseline;">Design Gurus</span> <span style="display: inline-block; padding: 0.25em 0.6em; font-size: 75%; font-weight: 700; line-height: 1; color: #ffffff; background-color: #FF6347; border-radius: 0.25rem; text-align: center; vertical-align: baseline;">Educative.io</span></p>
<p><strong>ATTENTION: 这些题目还没有看</strong></p>
<h2 id="Introduction-to-Multi-threaded-Pattern"><a href="#Introduction-to-Multi-threaded-Pattern" class="headerlink" title="Introduction to Multi-threaded Pattern"></a>Introduction to Multi-threaded Pattern</h2><p>In many algorithms, concurrency and thread safety are very important. With technical interviews in mind, we can easily apply these concepts to most coding problems and stand out from the crowd.</p>
<p><strong>Thread safety</strong> can be easily added to any algorithm that uses multiple threads.</p>
<p>Algorithms can be made <strong>multi-threaded</strong> to perform multiple concurrent tasks or to perform pre-fetching or post-processing functions to speed things up.</p>
<p>Let’s see this pattern in action.</p>
<h2 id="Same-Tree"><a href="#Same-Tree" class="headerlink" title="Same Tree"></a>Same Tree</h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>Given the roots of two binary trees ‘p’ and ‘q’, write a function to check if they are the same or not.</p>
<p>Two binary trees are considered the same if they met following two conditions:</p>
<ol>
<li>Both tree are structurally identical.</li>
<li>Each corresponding node on both the trees have the same value.</li>
</ol>
<p><strong>Example 1</strong>:</p>
<p>Given the following two binary trees:</p>
<p><img src="/28-pattern-multi-thread/index/1.png"></p>
<p><strong>Output</strong>: true</p>
<p><strong>Explanation</strong>: Both trees are structurally identical and have same values.</p>
<p><strong>Example 2</strong>:</p>
<p>Given the following two binary trees:</p>
<p><img src="/28-pattern-multi-thread/index/2.png"></p>
<p><strong>Output</strong>: false</p>
<p><strong>Explanation</strong>: Trees are structurally different.</p>
<p><strong>Example 3</strong>:</p>
<p>Given the following two binary trees:</p>
<p><img src="/28-pattern-multi-thread/index/3.png"></p>
<p><strong>Output</strong>: false</p>
<p><strong>Explanation</strong>: Corresponding nodes have different value ( 4 &amp; 9 ).</p>
<p><strong>Constraints:</strong></p>
<ul>
<li>The number of nodes in both trees is in the range <code>[0, 100]</code>.</li>
<li>-10^4 &lt;= Node.val &lt;= 10^4</li>
</ul>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>A simple solution would be to recursively check each corresponding node of the two trees. If one of the trees do not have a corresponding node or their values differ, we can conclude that the trees are not the same.</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>Here is what our algorithm will look like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val):</span></span><br><span class="line"><span class="comment">#     self.val = val</span></span><br><span class="line"><span class="comment">#     self.left = None</span></span><br><span class="line"><span class="comment">#     self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isSameTree</span>(<span class="params">self, p, q</span>):</span></span><br><span class="line">    <span class="comment"># p and q are both None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p <span class="keyword">and</span> <span class="keyword">not</span> q:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="comment"># one of p and q is None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p <span class="keyword">or</span> <span class="keyword">not</span> q:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment"># one of p and q has a different value</span></span><br><span class="line">    <span class="keyword">if</span> p.val != q.val:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check left and right subtree recursively</span></span><br><span class="line">    <span class="keyword">return</span> self.isSameTree(p.right, q.right) <span class="keyword">and</span> self.isSameTree(p.left, q.left)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  p = TreeNode(<span class="number">10</span>)</span><br><span class="line">  p.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">  p.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">  p.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">  p.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">  q = TreeNode(<span class="number">10</span>)</span><br><span class="line">  q.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">  q.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">  q.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">  q.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">  sol = Solution()</span><br><span class="line">  <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br><span class="line">  q.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line">  <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br><span class="line">  p.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line">  <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line">  </span><br><span class="line">  p.left.val = <span class="number">9</span></span><br><span class="line">  <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Time Complexity</strong></p>
<p>The solution will take O(min(M, N)) time, where ‘M’ and ‘N’ are the number of nodes in the given trees respectively. We are taking minimum of ‘M’ and ‘N’, since as soon as we see a difference in value or structure, we do not check the remaining trees.</p>
<p><strong>Space Complexity</strong></p>
<p>We will need O(N) space for the recursion stack in the worst case (when the binary tree is a list). Overall, we will need to store nodes equal to the height of the tree, hence, O(H) space complexity, where H is the height of the given tree.</p>
<h3 id="Making-the-Algorithm-Multi-threaded"><a href="#Making-the-Algorithm-Multi-threaded" class="headerlink" title="Making the Algorithm Multi-threaded"></a>Making the Algorithm Multi-threaded</h3><p>To further improve the algorithm, we can make <strong>isSameTree()</strong> multi-threaded to check the left and right subtrees in separate threads.</p>
<p>We can find how many processors the machine has on which our algorithm is running. We will, then, start multiple threads so that each core can run one thread.</p>
<p>We will use a Volatile Boolean variable <strong>isSame</strong> so that multiple threads can update its value concurrently.</p>
<p>Here is the code that takes care of this scenario:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.isSame = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSameTree</span>(<span class="params">self, p, q</span>):</span></span><br><span class="line">        self.isSame = <span class="literal">True</span></span><br><span class="line">        num_threads = os.cpu_count()</span><br><span class="line">        <span class="keyword">return</span> self.isSameTree_multi_threaded(p, q, num_threads)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSameTree_multi_threaded</span>(<span class="params">self, p, q, num_threads</span>):</span></span><br><span class="line">        <span class="comment"># p and q are both None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> p <span class="keyword">and</span> <span class="keyword">not</span> q:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># one of p and q is None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> p <span class="keyword">or</span> <span class="keyword">not</span> q:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># one of p and q has a different value</span></span><br><span class="line">        <span class="keyword">if</span> p.val != q.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if we can start more threads, we will spawn a new thread to check the</span></span><br><span class="line">        <span class="comment"># right subtree, otherwise we will do everything in the current thread</span></span><br><span class="line">        <span class="keyword">if</span> num_threads &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># spawn a separate thread for checking the right sub-tree</span></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">check_right_subtree</span>():</span></span><br><span class="line">                <span class="keyword">nonlocal</span> p, q, num_threads</span><br><span class="line">                self.isSame &amp;= self.isSameTree_multi_threaded(p.right, q.right, num_threads // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            t1 = threading.Thread(target=check_right_subtree)</span><br><span class="line">            t1.start()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># check the left sub-tree in the current thread</span></span><br><span class="line">            self.isSame &amp;= self.isSameTree_multi_threaded(p.left, q.left, num_threads // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            t1.join()  <span class="comment"># wait for the thread checking the right sub-tree</span></span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># do everything in the current thread</span></span><br><span class="line">            self.isSame &amp;= self.isSameTree_multi_threaded(p.right, q.right, <span class="number">0</span>) <span class="keyword">and</span> self.isSameTree_multi_threaded(p.left, q.left, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.isSame</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = TreeNode(<span class="number">10</span>)</span><br><span class="line">    p.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">    p.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">    p.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">    p.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">    q = TreeNode(<span class="number">10</span>)</span><br><span class="line">    q.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">    q.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">    q.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">    q.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">    sol = Solution()</span><br><span class="line">    <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br><span class="line">    q.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br><span class="line">    p.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br><span class="line">    p.left.val = <span class="number">9</span></span><br><span class="line">    <span class="built_in">print</span>(sol.isSameTree(p, q))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Time-and-Space-Complexities"><a href="#Time-and-Space-Complexities" class="headerlink" title="Time and Space Complexities"></a>Time and Space Complexities</h3><p>Everything has the same complexity as the previous solution.</p>
<h2 id="Invert-Binary-Tree"><a href="#Invert-Binary-Tree" class="headerlink" title="Invert Binary Tree"></a><strong>Invert Binary Tree</strong></h2><h3 id="Problem-Statement-1"><a href="#Problem-Statement-1" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>Given the root of a binary tree, invert it.</p>
<p><strong>Example</strong>:</p>
<p>Given the following two binary trees:</p>
<p><img src="/28-pattern-multi-thread/index/4.png"></p>
<p><strong>Constraints:</strong></p>
<ul>
<li>The number of nodes in both trees is in the range <code>[0, 100]</code>.</li>
<li>-100 &lt;= Node.val &lt;= 100</li>
</ul>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>This problem is quite similar to <code>Same Tree</code>. We can follow the same approach. After swapping left and right child of a node, we will recursively invert its left and right subtrees.</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><p>Here is what our algorithm will look like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invertTree</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        <span class="comment"># Base case: if the root is None, just return None</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Swap the left and right children of the current node</span></span><br><span class="line">        root.left, root.right = root.right, root.left</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Recursively invert the left and right subtrees</span></span><br><span class="line">        self.invertTree(root.left)</span><br><span class="line">        self.invertTree(root.right)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># Construct the binary search tree</span></span><br><span class="line">    root = TreeNode(<span class="number">10</span>)</span><br><span class="line">    root.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">    root.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">    root.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">    root.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line">    root.right.right = TreeNode(<span class="number">19</span>)</span><br><span class="line">    root.right.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Invert the binary search tree</span></span><br><span class="line">    sol = Solution()</span><br><span class="line">    sol.invertTree(root)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Print out the results to check if the tree was inverted correctly</span></span><br><span class="line">    <span class="built_in">print</span>(root.right.val == <span class="number">4</span>)  <span class="comment"># Expect: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.val == <span class="number">15</span>)  <span class="comment"># Expect: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.right.val == <span class="number">14</span>)  <span class="comment"># Expect: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.left.val == <span class="number">19</span>)  <span class="comment"># Expect: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.left.left.val == <span class="number">20</span>)  <span class="comment"># Expect: True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Time-Complexity"><a href="#Time-Complexity" class="headerlink" title="Time Complexity"></a>Time Complexity</h3><p>Since we traverse each node once, the solution will take O(N) time where ‘N’ is the total number of nodes in the tree.</p>
<h3 id="Space-Complexity"><a href="#Space-Complexity" class="headerlink" title="Space Complexity"></a>Space Complexity</h3><p>We will need O(N) space for the recursion stack in the worst case (when the binary tree is a list). Overall, we will need to store nodes equal to the height of the tree, hence, O(H) space complexity, where H is the height of the given tree.</p>
<h3 id="Making-the-Algorithm-Multi-threaded-1"><a href="#Making-the-Algorithm-Multi-threaded-1" class="headerlink" title="Making the Algorithm Multi-threaded"></a>Making the Algorithm Multi-threaded</h3><p>To further improve the algorithm, we can make <strong>invertTree()</strong> multi-threaded to invert left and right subtrees in separate threads.</p>
<p>We can find how many cores the machine has on which our algorithm is running. We will, then, start multiple threads so that each core can run one thread.</p>
<p>Here is the code that takes care of this scenario:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="comment"># Definition for a binary search tree node</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invertTree</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        num_threads = multiprocessing.cpu_count()  <span class="comment"># Number of available processors</span></span><br><span class="line">        <span class="keyword">return</span> self.invert_tree_multithreaded(root, num_threads)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invert_tree_multithreaded</span>(<span class="params">self, root, num_threads</span>):</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Invert the current node</span></span><br><span class="line">        root.left, root.right = root.right, root.left</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> num_threads &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># Spawn a separate thread to invert the left subtree</span></span><br><span class="line">            t1 = threading.Thread(target=self.invert_tree_multithreaded, args=(root.left, num_threads // <span class="number">2</span>))</span><br><span class="line">            t1.start()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Invert the right subtree in the same thread</span></span><br><span class="line">            self.invert_tree_multithreaded(root.right, num_threads // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            t1.join()  <span class="comment"># Wait for the thread inverting the left subtree</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.invert_tree_multithreaded(root.left, <span class="number">0</span>)</span><br><span class="line">            self.invert_tree_multithreaded(root.right, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    root = TreeNode(<span class="number">10</span>)</span><br><span class="line">    root.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">    root.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">    root.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">    root.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line">    root.right.right = TreeNode(<span class="number">19</span>)</span><br><span class="line">    root.right.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    sol = Solution()</span><br><span class="line">    sol.invertTree(root)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(root.right.val == <span class="number">4</span>)  <span class="comment"># Expected: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.val == <span class="number">15</span>)  <span class="comment"># Expected: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.right.val == <span class="number">14</span>)  <span class="comment"># Expected: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.left.val == <span class="number">19</span>)  <span class="comment"># Expected: True</span></span><br><span class="line">    <span class="built_in">print</span>(root.left.left.left.val == <span class="number">20</span>)  <span class="comment"># Expected: True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Time-and-Space-Complexities-1"><a href="#Time-and-Space-Complexities-1" class="headerlink" title="Time and Space Complexities"></a>Time and Space Complexities</h3><p>Everything has the same complexity as the previous solution.</p>
<h2 id="Binary-Search-Tree-Iterator"><a href="#Binary-Search-Tree-Iterator" class="headerlink" title="Binary Search Tree Iterator"></a>Binary Search Tree Iterator</h2><h3 id="Problem-Statement-2"><a href="#Problem-Statement-2" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>Implement an iterator for the in-order traversal of a binary search tree (BST). That is, given a BST, we need to implement two functions:</p>
<p><strong>bool hasNext()</strong>: Returns true if at least one element is left in the in-order traversal of the BST. <strong>int next()</strong>: Return the next element in the in-order traversal of the BST.</p>
<p><strong>Example</strong>:</p>
<p>Given the following BST:</p>
<p><img src="/28-pattern-multi-thread/index/5.png"></p>
<p>Here is the in-order traversal of this tree: [1, 4, 10, 14, 15, 19, 20]</p>
<p>Here is the expected output from the algorithm based on different calls:</p>
<p>hasNext() -&gt; <strong>true</strong></p>
<p>next() -&gt; <strong>1</strong></p>
<p>next() -&gt; <strong>4</strong></p>
<p>hasNext() -&gt; <strong>true</strong></p>
<p>next() -&gt; <strong>10</strong></p>
<p>next() -&gt; <strong>14</strong></p>
<p>next() -&gt; <strong>15</strong></p>
<p>next() -&gt; <strong>19</strong></p>
<p>next() -&gt; <strong>20</strong></p>
<p>hasNext() -&gt; <strong>false</strong></p>
<p><strong>Constraints:</strong></p>
<ul>
<li>The number of nodes in the tree is in the range [1, 10^5].</li>
<li>0 &lt;= Node.val &lt;= 106</li>
<li>At most 105 calls will be made to hasNext, and next.</li>
</ul>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><p>A brute force solution could be to store the in-order traversal of the BST in an array and used that array to process the two functions <strong>next()</strong> and <strong>hasNext()</strong>. We can maintain a pointer in the array, which points to the next element to be returned to the caller. This algorithm will take O(N) space for storing all elements in the array, and O(N) time to traverse the tree. Both the operations will take O(1) time complexity, as we have pre-processed all the data to store the in-order traversal of the BST in the array.</p>
<h3 id="Transforming-a-Recursive-Algorithm-to-an-Iterative-one"><a href="#Transforming-a-Recursive-Algorithm-to-an-Iterative-one" class="headerlink" title="Transforming a Recursive Algorithm to an Iterative one"></a>Transforming a Recursive Algorithm to an Iterative one</h3><p>We know that we can perform the in-order traversal of a BST recursively. But for the iterator, we can’t use recursion as we can’t stop recursion in the middle to return the required element; this way, we will lose the recursive state of the traversal. Also, we didn’t want to perform the in-order traversal every time <strong>next()</strong> or <strong>hasNext()</strong> is called; this will make these function O(N) operations.</p>
<p>We know that we can transform a recursive solution to make it iterative using a stack. This was exactly what we need! This way, we can control the recursion by saving the state of the in-order traversal of the BST in the stack, and later we can resume the tree traversal when <strong>next()</strong> is called again.</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><p>Here is what our algorithm will look like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># definition for a binary search tree node</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#     self.val = val</span></span><br><span class="line"><span class="comment">#     self.left = left</span></span><br><span class="line"><span class="comment">#     self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, root: TreeNode</span>):</span></span><br><span class="line">    self.stack = <span class="built_in">list</span>()</span><br><span class="line">    self.traverse_left(root)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns whether we have a next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">return</span> self.stack</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns the next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">    tmpNode = self.stack.pop()</span><br><span class="line">    self.traverse_left(tmpNode.right)</span><br><span class="line">    <span class="keyword">return</span> tmpNode.val</span><br><span class="line">        </span><br><span class="line">  <span class="comment"># traverse the left sub-tree to push all nodes on the stack</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">traverse_left</span>(<span class="params">self, node</span>):</span></span><br><span class="line">    <span class="keyword">while</span> node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">      self.stack.append(node)</span><br><span class="line">      node = node.left</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">  root = TreeNode(<span class="number">10</span>)</span><br><span class="line">  root.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">  root.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">  root.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">  root.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line">  root.right.right = TreeNode(<span class="number">19</span>)</span><br><span class="line">  root.right.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  sol = Solution(root)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Time-Complexity-1"><a href="#Time-Complexity-1" class="headerlink" title="Time Complexity"></a>Time Complexity</h3><ul>
<li>The <strong>hasNext()</strong> will take O(1) time.</li>
<li>Since <strong>next()</strong> calls the <strong>traverseLeft()</strong> function which traverses the left subtree and in the worst case the left subtree could contain all elements (practically it would be a list), hence, <strong>next()</strong> can take O(N) time in the worst case. One thing to note there though, <strong>traverseLeft()</strong> processes each element only once. This means, amortized cost of <strong>traverseLeft()</strong> will be O(1) for ‘n’ calls of next(), therefore, next() has O(1) amortized cost.</li>
</ul>
<h3 id="Space-Complexity-1"><a href="#Space-Complexity-1" class="headerlink" title="Space Complexity"></a>Space Complexity</h3><p>We will need O(N) space for the stack in the worst case (when the BST is a list). Overall, we will need to store nodes equal to the height of the tree, hence,<br>O(H) space complexity, where H is the height of the given tree.</p>
<h3 id="Making-the-Algorithm-Thread-Safe"><a href="#Making-the-Algorithm-Thread-Safe" class="headerlink" title="Making the Algorithm Thread Safe"></a>Making the Algorithm Thread Safe</h3><p>Our algorithm does not have thread-safety. The algorithm would fail if multiple threads access the same <strong>BSTIterator</strong> object. We could get a synchronization issue in the next() function for the following two lines:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TreeNode tmpNode = stack.pop<span class="literal">()</span>;</span><br><span class="line">traverse<span class="constructor">Left(<span class="params">tmpNode</span>.<span class="params">right</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>If two threads access the function concurrently, the stack could end up in a bad state.</p>
<p>Here is what can happen. Suppose one thread executes the first line to pop an element from the stack. Before it executes the next line (to traverse the left subtree), another thread which is also processing these lines, can also pop another element from the stack, thus, making the stack invalid.</p>
<p>This means we need to synchronize this function so that only one thread is allowed to process next() at any time.</p>
<p>Here is the new synchronized version of the algorithm.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="comment"># definition for a binary search tree node</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#     self.val = val</span></span><br><span class="line"><span class="comment">#     self.left = left</span></span><br><span class="line"><span class="comment">#     self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, root: TreeNode</span>):</span></span><br><span class="line">    self.stack = <span class="built_in">list</span>()</span><br><span class="line">    self.lock = multiprocessing.Lock()</span><br><span class="line">    self.traverse_left(root)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns whether we have a next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">return</span> self.stack</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns the next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.lock.acquire()</span><br><span class="line">    tmpNode = self.stack.pop()</span><br><span class="line">    self.traverse_left(tmpNode.right)</span><br><span class="line">    self.lock.release()</span><br><span class="line">    <span class="keyword">return</span> tmpNode.val</span><br><span class="line">        </span><br><span class="line">  <span class="comment"># traverse the left sub-tree to push all nodes on the stack</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">traverse_left</span>(<span class="params">self, node</span>):</span></span><br><span class="line">    <span class="keyword">while</span> node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">      self.stack.append(node)</span><br><span class="line">      node = node.left</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">  root = TreeNode(<span class="number">10</span>)</span><br><span class="line">  root.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">  root.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">  root.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">  root.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line">  root.right.right = TreeNode(<span class="number">19</span>)</span><br><span class="line">  root.right.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  sol = Solution(root)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Making-the-Algorithm-Multi-threaded-2"><a href="#Making-the-Algorithm-Multi-threaded-2" class="headerlink" title="Making the Algorithm Multi-threaded"></a>Making the Algorithm Multi-threaded</h3><p>To further improve the algorithm, we can make <strong>next()</strong> multi-threaded so that can return the element to the caller immediately and spawn a separate thread to perform the post-processing required to traverse the left subtree.</p>
<p>In the <strong>next()</strong> function, we do have the required node available right away, but we could not return to the caller before we traverse the left subtree of the right child of the current node:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traverse<span class="constructor">Left(<span class="params">tmpNode</span>.<span class="params">right</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>we can spawn a new thread to process this traversal and return the element to the caller. This way, the caller is unblocked as it has the data quickly, and all the post-processing is done in a separate thread.</p>
<p>This made the algorithm a bit complex though. Now, whenever we are starting a new execution of <strong>next()</strong> or <strong>hasNext()</strong>, we need to ensure any previous thread doing the post-processing has finished. This means that we have to add a check before processing <strong>next()</strong> or <strong>hasNext()</strong> to wait and call <strong>join()</strong> on the previous thread if it has not already finished.</p>
<p>Here is the code that takes care of this scenario:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="comment"># definition for a binary search tree node</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#     self.val = val</span></span><br><span class="line"><span class="comment">#     self.left = left</span></span><br><span class="line"><span class="comment">#     self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, root: TreeNode</span>):</span></span><br><span class="line">    self.stack = multiprocessing.Manager().<span class="built_in">list</span>()</span><br><span class="line">    self.lock = multiprocessing.Lock()</span><br><span class="line">    self.t1 = <span class="literal">None</span></span><br><span class="line">    self.traverse_left(self.stack, root)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns whether we have a next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.check_thread()</span><br><span class="line">    <span class="keyword">return</span> self.stack</span><br><span class="line"></span><br><span class="line">  <span class="comment"># returns the next smallest number</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.lock.acquire()</span><br><span class="line">    self.check_thread()</span><br><span class="line">    tmpNode = self.stack.pop()</span><br><span class="line">    self.t1 = multiprocessing.Process(target=self.traverse_left, args=(self.stack, tmpNode.right))</span><br><span class="line">    self.t1.start()</span><br><span class="line">    self.lock.release()</span><br><span class="line">    <span class="keyword">return</span> tmpNode.val</span><br><span class="line">        </span><br><span class="line">  <span class="comment"># traverse the left sub-tree to push all nodes on the stack</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">traverse_left</span>(<span class="params">self, stack, node</span>):</span></span><br><span class="line">    <span class="keyword">while</span> node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">      stack.append(node)</span><br><span class="line">      node = node.left</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># if the previous thread is active, wait before it finishes</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">check_thread</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.t1 <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.t1.is_alive():</span><br><span class="line">        self.t1.join() <span class="comment"># wait for the thread traversing the left subtree </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">  root = TreeNode(<span class="number">10</span>)</span><br><span class="line">  root.left = TreeNode(<span class="number">4</span>)</span><br><span class="line">  root.left.left = TreeNode(<span class="number">1</span>)</span><br><span class="line">  root.right = TreeNode(<span class="number">15</span>)</span><br><span class="line">  root.right.left = TreeNode(<span class="number">14</span>)</span><br><span class="line">  root.right.right = TreeNode(<span class="number">19</span>)</span><br><span class="line">  root.right.right.right = TreeNode(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  sol = Solution(root)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;next() -&gt; &quot;</span> + <span class="built_in">str</span>(sol.<span class="built_in">next</span>()))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;hasNext() -&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bool</span>(sol.hasNext())))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Time-and-Space-Complexities-2"><a href="#Time-and-Space-Complexities-2" class="headerlink" title="Time and Space Complexities"></a>Time and Space Complexities</h3><p>Everything has the same complexity as the previous solution.</p>

    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>Author：<a href="https://hasuer.github.io">Hasuer</a>
            <p>Link：<a href="https://hasuer.github.io/28-pattern-multi-thread/index.html">https://hasuer.github.io/28-pattern-multi-thread/index.html</a>
            <p>Publish date：<a href="https://hasuer.github.io/28-pattern-multi-thread/index.html">May 28th 2024, 2:34:14 pm</a>
            <p>Update date：<a href="https://hasuer.github.io/28-pattern-multi-thread/index.html">May 28th 2024, 11:31:31 am</a>
            <p>License：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/29-miscellaneous/index.html" title="29. Miscellaneous">
                    <div class="nextTitle">29. Miscellaneous</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/27-pattern-prefix-sum/index.html" title="27. Pattern Prefix Sum">
                    <div class="prevTitle">27. Pattern Prefix Sum</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:12345@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/HasuerYu" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction-to-Multi-threaded-Pattern"><span class="toc-number">1.</span> <span class="toc-text">Introduction to Multi-threaded Pattern</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Same-Tree"><span class="toc-number">2.</span> <span class="toc-text">Same Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-Statement"><span class="toc-number">2.1.</span> <span class="toc-text">Problem Statement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution"><span class="toc-number">2.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">2.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-the-Algorithm-Multi-threaded"><span class="toc-number">2.4.</span> <span class="toc-text">Making the Algorithm Multi-threaded</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-and-Space-Complexities"><span class="toc-number">2.5.</span> <span class="toc-text">Time and Space Complexities</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Invert-Binary-Tree"><span class="toc-number">3.</span> <span class="toc-text">Invert Binary Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-Statement-1"><span class="toc-number">3.1.</span> <span class="toc-text">Problem Statement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1"><span class="toc-number">3.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-1"><span class="toc-number">3.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-Complexity"><span class="toc-number">3.4.</span> <span class="toc-text">Time Complexity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Space-Complexity"><span class="toc-number">3.5.</span> <span class="toc-text">Space Complexity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-the-Algorithm-Multi-threaded-1"><span class="toc-number">3.6.</span> <span class="toc-text">Making the Algorithm Multi-threaded</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-and-Space-Complexities-1"><span class="toc-number">3.7.</span> <span class="toc-text">Time and Space Complexities</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Binary-Search-Tree-Iterator"><span class="toc-number">4.</span> <span class="toc-text">Binary Search Tree Iterator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-Statement-2"><span class="toc-number">4.1.</span> <span class="toc-text">Problem Statement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2"><span class="toc-number">4.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transforming-a-Recursive-Algorithm-to-an-Iterative-one"><span class="toc-number">4.3.</span> <span class="toc-text">Transforming a Recursive Algorithm to an Iterative one</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">4.4.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-Complexity-1"><span class="toc-number">4.5.</span> <span class="toc-text">Time Complexity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Space-Complexity-1"><span class="toc-number">4.6.</span> <span class="toc-text">Space Complexity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-the-Algorithm-Thread-Safe"><span class="toc-number">4.7.</span> <span class="toc-text">Making the Algorithm Thread Safe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-the-Algorithm-Multi-threaded-2"><span class="toc-number">4.8.</span> <span class="toc-text">Making the Algorithm Multi-threaded</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-and-Space-Complexities-2"><span class="toc-number">4.9.</span> <span class="toc-text">Time and Space Complexities</span></a></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 41
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2024 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/02</span>
            <a class="archive-post-title" href="/34-conclusions/index.html">34. Conclusions</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/02</span>
            <a class="archive-post-title" href="/33-test-your-knowledge-hard/index.html">33. Test Your Knowledge (Hard)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span>
            <a class="archive-post-title" href="/32-test-your-knowledge-medium/index.html">32. Test Your Knowledge (Medium)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span>
            <a class="archive-post-title" href="/31-test-your-knowledge-easy-md/index.html">31. Test Your Knowledge (Easy).md</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/30</span>
            <a class="archive-post-title" href="/30-revision/index.html">30. Revision</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span>
            <a class="archive-post-title" href="/29-miscellaneous/index.html">29. Miscellaneous</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/28</span>
            <a class="archive-post-title" href="/28-pattern-multi-thread/index.html">28. Pattern Multi-thread</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span>
            <a class="archive-post-title" href="/27-pattern-prefix-sum/index.html">27. Pattern Prefix Sum</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/26</span>
            <a class="archive-post-title" href="/26-pattern-ordered-set/index.html">26. Pattern Ordered Set</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/25</span>
            <a class="archive-post-title" href="/25-pattern-union-find/index.html">25. Pattern Union Find</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/24</span>
            <a class="archive-post-title" href="/24-pattern-topological-sort-graph/index.html">24. Pattern Topological Sort (Graph)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/23</span>
            <a class="archive-post-title" href="/23-pattern-trie/index.html">23. Pattern Trie</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span>
            <a class="archive-post-title" href="/22-pattern-backtracking/index.html">22. Pattern Backtracking</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/21</span>
            <a class="archive-post-title" href="/21-pattern-01-knapsack-dynamic-programming/index.html">21. Pattern  01 Knapsack (Dynamic Programming)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/20</span>
            <a class="archive-post-title" href="/20-pattern-greedy-algorithms/index.html">20. Pattern Greedy Algorithms</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span>
            <a class="archive-post-title" href="/19-pattern-k-way-merge/index.html">19. Pattern K-way merge</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/18</span>
            <a class="archive-post-title" href="/18-pattern-top-k-elements/index.html">18. Pattern Top 'K' Elements</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span>
            <a class="archive-post-title" href="/17-pattern-bitwise-xor/index.html">17. Pattern Bitwise XOR</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span>
            <a class="archive-post-title" href="/16-pattern-modified-binary-search/index.html">16. Pattern Modified Binary Search</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/15</span>
            <a class="archive-post-title" href="/15-pattern-subsets/index.html">15. Pattern Subsets</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/14</span>
            <a class="archive-post-title" href="/14-pattern-two-heaps/index.html">14. Pattern Two Heaps</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/13</span>
            <a class="archive-post-title" href="/13-pattern-island-matrix-traversal/index.html">13. Pattern Island (Matrix traversal)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span>
            <a class="archive-post-title" href="/12-pattern-graphs/index.html">12. Pattern Graphs</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/11-pattern-tree-depth-first-search/index.html">11. Pattern Tree Depth First Search</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/10</span>
            <a class="archive-post-title" href="/10-pattern-tree-breadth-first-search/index.html">10. Pattern Tree Breadth First Search</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/09</span>
            <a class="archive-post-title" href="/9-pattern-hash-maps/index.html">9. Pattern Hash Maps</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span>
            <a class="archive-post-title" href="/8-pattern-monotonic-stack/index.html">8. Pattern Monotonic Stack</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/07</span>
            <a class="archive-post-title" href="/7-pattern-stack/index.html">7. Pattern Stack</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/06</span>
            <a class="archive-post-title" href="/6-pattern-in-place-reversal-of-a-linkedlist/index.html">6. Pattern In-place Reversal of a LinkedList</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/05</span>
            <a class="archive-post-title" href="/5-pattern-cyclic-sort/index.html">5. Pattern Cyclic Sort</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/04</span>
            <a class="archive-post-title" href="/4-pattern-merge-intervals/index.html">4. Pattern Merge Intervals</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/03</span>
            <a class="archive-post-title" href="/3-pattern-sliding-window/index.html">3. Pattern Sliding Window</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/02</span>
            <a class="archive-post-title" href="/2-pattern-fast-slow-pointers/index.html">2. Pattern Fast_Slow pointers</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/01</span>
            <a class="archive-post-title" href="/1-pattern-two-pointers/index.html">1. Pattern Two Pointers</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/30</span>
            <a class="archive-post-title" href="/0-introduction/index.html">0.Introduction</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2022 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/12</span>
            <a class="archive-post-title" href="/ubuntu20-04%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEmysql8-%E8%AF%A6%E7%BB%86/index.html">Ubuntu20.04安装配置MySQL8(详细)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span>
            <a class="archive-post-title" href="/axios%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">Axios学习笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span>
            <a class="archive-post-title" href="/promise%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">Promise学习笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span>
            <a class="archive-post-title" href="/nginx%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">Nginx学习笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span>
            <a class="archive-post-title" href="/ajax%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">AJAX学习笔记</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/07</span>
            <a class="archive-post-title" href="/git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">Git学习笔记</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="Interview">
                <span class="iconfont-archer">&#xe606;</span>
                Interview
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="技术笔记">
            <span class="iconfont-archer">&#xe60a;</span>
            技术笔记
        </span>
    
        <span class="sidebar-category-name" data-categories="Grokking-Interview-Pattern">
            <span class="iconfont-archer">&#xe60a;</span>
            Grokking-Interview-Pattern
        </span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMeta = {
        root: "/",
        author: "Hasuer"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20210823"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20210823"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20210823" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
